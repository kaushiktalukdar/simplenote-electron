(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{893:function(e,t,n){"use strict";n.r(t),n.d(t,"NoteList",(function(){return q}));var r=n(0),o=n.n(r),a=n(872),i=n(8),c=n.n(i),s=n(111);function u(){return o.a.createElement("svg",{className:"icon-feed",xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M2,8.667V12c5.515,0,10,4.485,10,10h3.333C15.333,14.637,9.363,8.667,2,8.667z M2,2v3.333 c9.19,0,16.667,7.477,16.667,16.667H22C22,10.955,13.045,2,2,2z M4.5,17C3.118,17,2,18.12,2,19.5S3.118,22,4.5,22S7,20.88,7,19.5 S5.882,17,4.5,17z"}))}var l=n(4),f=n(666),p=n.n(f),d=n(182),h=function(e,t){return e.length>0?e.reduce((function(e,t){var n=t.filter,r=t.replacer,o="string"==typeof n&&Object(d.b)(n),a=o&&o.length>0?new RegExp(Object(l.escapeRegExp)(o),"gi"):n;return p()(e,a,r)}),t).map((function(e,t){return e&&"string"!=typeof e?o.a.cloneElement(e,{key:t}):e})):t},y=function(e){return{filter:e,replacer:function(e){if(e.length)return o.a.createElement("span",{className:"search-match"},e)}}},m=n(669),g=n.n(m);function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e,t){return e?(n=t,g()(n.replace(/(\s)\s+/g,"$1"),{stripListLeaders:!1})||t):t;var n},N=new Map,O=function(e){var t=function(e){return e.systemTags.includes("markdown")}(e),n=N.get(e.content);if(n){var r=b(n,2),o=r[0],a=r[1];if(o===t)return a}var i=e.content||"",c={title:w(t,function(e){var t=new RegExp("\\s*([^\n]{1,".concat(64,"})"),"g").exec(e);return t?b(t,2)[1]:"New Note…"}(i)),preview:w(t,function(e){var t="",n=0,r=e.indexOf("\n");if(-1===r)return"";for(;r>-1&&n<4;){var o=e.indexOf("\n",r);if(-1===o)return t+e.slice(r).trim();var a=e.slice(r,o).trim();a&&(t+=a+"\n",n++),r=o+1}return t.trim()}(i))};return N.set(e.content,[t,c]),c};var E=n(123),S=n(155);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R(e);if(t){var o=R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D(this,n)}}function D(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(i,e);var t,n,r,a=k(i);function i(e){var t,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=a.call(this,e),n=C(t),o=void 0,(r="createdAt")in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,t.createdAt=Date.now(),t}return t=i,(n=[{key:"componentDidUpdate",value:function(e){var t,n,r=this;(null===(t=e.note)||void 0===t?void 0:t.content)!==(null===(n=this.props.note)||void 0===n?void 0:n.content)&&this.props.invalidateHeight(),this.props.lastUpdated<1e3&&!this.updateScheduled&&(this.updateScheduled=setTimeout((function(){return r.forceUpdate()}),1e3))}},{key:"render",value:function(){var e=this.props,t=e.displayMode,n=e.hasPendingChanges,r=e.isOpened,a=e.lastUpdated,i=e.noteId,s=e.note,l=e.openNote,f=e.pinNote,p=e.searchQuery,m=e.style;if(!s)return o.a.createElement("div",null,"Couldn't find note");var g=O(s),b=g.title,v=g.preview,w=s.systemTags.includes("pinned"),N=!!s.publishURL,E=a-this.createdAt>1e3&&Date.now()-a<1200,S=c()("note-list-item",{"note-list-item-selected":r,"note-list-item-pinned":w,"note-recently-updated":E,"published-note":N}),j=Object(d.a)(p).map(y);return o.a.createElement("div",{style:m,className:S},o.a.createElement("div",{className:"note-list-item-pinner",tabIndex:0,onClick:function(){return f(i,!w)}}),o.a.createElement("div",{className:"note-list-item-text theme-color-border",tabIndex:0,onClick:function(){return l(i)}},o.a.createElement("div",{className:"note-list-item-title"},o.a.createElement("span",null,n&&"⚠️ ",h(j,b)),N&&o.a.createElement("div",{className:"note-list-item-published-icon"},o.a.createElement(u,null))),"expanded"===t&&v.length>0&&o.a.createElement("div",{className:"note-list-item-excerpt"},v.split("\n").map((function(e,t){return o.a.createElement(o.a.Fragment,{key:t},t>0&&o.a.createElement("br",null),h(j,e.slice(0,200)))}))),"comfy"===t&&v.length>0&&o.a.createElement("div",{className:"note-list-item-excerpt"},h(j,v.slice(0,200)))))}}])&&x(t.prototype,n),r&&x(t,r),i}(r.Component),I={openNote:E.a.ui.openNote,pinNote:E.a.data.pinNote},L=Object(s.b)((function(e,t){var n,r=t.noteId;return{displayMode:e.settings.noteDisplay,hasPendingChanges:S.c(e,r),isOpened:e.ui.openedNote===r,lastUpdated:null!==(n=e.simperium.lastRemoteUpdate.get(r))&&void 0!==n?n:-1/0,note:e.data.notes.get(r),searchQuery:e.ui.searchQuery}}),I)(A),T=n(341);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z(e);if(t){var o=z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F(this,n)}}function F(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?H(e):t}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(u,e);var t,n,i,s=Q(u);function u(){var e;M(this,u);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return V(H(e=s.call.apply(s,[this].concat(n))),"state",{heightCache:new a.c({defaultHeight:135,fixedWidth:!0,keyMapper:function(t){var n=e.props,r=n.filteredNotes,o=n.searchQuery,a=n.tagResultsFound;return 0===a&&0===r.length?"no-notes":0===o.length||0===a?r[t]:0===t?"tag-suggestions":1===t?"notes-header":r[t-2]}}),lastNoteDisplay:null}),V(H(e),"list",Object(r.createRef)()),V(H(e),"handleShortcut",(function(t){if(e.props.keyboardShortcuts){var n=t.ctrlKey,r=t.code,o=t.metaKey,a=t.shiftKey,i=e.props,c=i.isSmallScreen,s=i.showNoteList,u=n||o;return u&&a&&"KeyK"===r?(e.props.selectNoteAbove(),t.stopPropagation(),t.preventDefault(),!1):u&&a&&"KeyJ"===r?(e.props.selectNoteBelow(),t.stopPropagation(),t.preventDefault(),!1):c&&u&&a&&"KeyL"===r?(e.props.toggleNoteList(),t.stopPropagation(),t.preventDefault(),!1):!c||!s||"Enter"!==r||(e.props.openNote(),t.stopPropagation(),t.preventDefault(),!1)}})),V(H(e),"toggleShortcuts",(function(t){t?window.addEventListener("keydown",e.handleShortcut,!0):window.removeEventListener("keydown",e.handleShortcut,!0)})),e}return t=u,(n=[{key:"componentDidMount",value:function(){this.toggleShortcuts(!0)}},{key:"componentWillUnmount",value:function(){this.toggleShortcuts(!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.filteredNotes,i=t.hasLoaded,s=t.noteDisplay,u=t.onEmptyTrash,l=t.openedNote,f=t.searchQuery,p=t.showTrash,d=t.tagResultsFound,h=this.state.heightCache,y=function(e,t,n){return 0===t.length||0===n?e:["tag-suggestions","notes-header"].concat(B(e.length>0?e:["no-notes"]))}(n,f,d),m=y.findIndex((function(e){return e===l})),g=function(e,t){var n=t.heightCache;return function(t){var r=t.index,i=t.key,c=t.parent,s=t.style,u=e[r];return"no-notes"===u?o.a.createElement(a.b,{cache:n,columnIndex:0,key:"no-notes",parent:c,rowIndex:r},o.a.createElement("div",{className:"note-list is-empty",style:W(W({},s),{},{height:200})},o.a.createElement("span",{className:"note-list-placeholder"},"No Notes"))):"tag-suggestions"===u||"notes-header"===u?"tag-suggestions"===u?o.a.createElement(a.b,{cache:n,columnIndex:0,key:"tag-suggestions",parent:c,rowIndex:r},o.a.createElement(T.a,null)):o.a.createElement(a.b,{cache:n,columnIndex:0,key:"notes-header",parent:c,rowIndex:r},o.a.createElement("div",{className:"note-list-header"},"Notes")):o.a.createElement(a.b,{cache:n,columnIndex:0,key:i,parent:c,rowIndex:r},o.a.createElement(L,{invalidateHeight:function(){return n.clear(r,0)},noteId:u,style:s}))}}(y,{heightCache:h}),b=0===y.length,v=o.a.createElement("div",{className:"note-list-empty-trash theme-color-border"},o.a.createElement("button",{type:"button",className:"button button-borderless button-danger",onClick:u},"Empty Trash"));return o.a.createElement("div",{className:c()("note-list",{"is-empty":b})},b?o.a.createElement("span",{className:"note-list-placeholder"},i?"No Notes":"Loading Notes"):o.a.createElement(r.Fragment,null,o.a.createElement("div",{className:"note-list-items ".concat(s)},o.a.createElement(a.a,null,(function(t){var n=t.height,r=t.width;return o.a.createElement(a.d,{ref:e.list,estimatedRowSize:126,height:n,noteDisplay:s,notes:y,rowCount:y.length,rowHeight:h.rowHeight,rowRenderer:g,scrollToIndex:m,width:r})}))),p&&v))}}])&&U(t.prototype,n),i&&U(t,i),u}(r.Component);V(q,"displayName","NoteList"),V(q,"getDerivedStateFromProps",(function(e,t){return t.heightCache.clear(0),t.heightCache.clear(1),t.heightCache.clear(2),e.noteDisplay!==t.lastNoteDisplay?(t.heightCache.clearAll(),{lastNoteDisplay:e.noteDisplay}):null}));var G={onEmptyTrash:function(){throw new Error("Empty trash!")},openNote:E.a.ui.openNote,selectNoteAbove:E.a.ui.selectNoteAbove,selectNoteBelow:E.a.ui.selectNoteBelow,toggleNoteList:E.a.ui.toggleNoteList};t.default=Object(s.b)((function(e){return{hasLoaded:e.ui.hasLoadedNotes,isSmallScreen:S.b(e),keyboardShortcuts:e.settings.keyboardShortcuts,noteDisplay:e.settings.noteDisplay,filteredNotes:e.ui.filteredNotes,openedNote:e.ui.openedNote,openedTag:e.ui.openedTag,searchQuery:e.ui.searchQuery,showNoteList:e.ui.showNoteList,showTrash:e.ui.showTrash,tagResultsFound:e.ui.tagSuggestions.length}}),G)(q)}}]);